{% extends 'base.html' %}
{% block content %}
<h4>Student Enrollment and Course Selection</h4>
<form method="post" class="row g-3">
  <div class="col-md-4">
    <label for="student_id" class="form-label">Student ID</label>
    <input type="number" class="form-control" id="student_id" name="student_id" placeholder="E.g., 575001" required>
  </div>
  <div class="col-md-4">
    <label for="course_id" class="form-label">Select Modules</label>
    <select id="course_id" name="course_id" class="form-select" required>
      <option value="" selected disabled>Please select a module</option>
      {% for c in courses %}
        <option value="{{ c.id }}">{{ c.name }} (ID: {{ c.id }})</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-4">
    <label for="graduation_date" class="form-label">Graduation Date</label>
    <input type="date" class="form-control" id="graduation_date" name="graduation_date">
  </div>
  <div class="col-12">
    <button type="submit" class="btn btn-primary">Create and Select Modules</button>
  </div>
</form>

<hr class="my-4">

<div class="card shadow-sm">
  <div class="card-header bg-light">
    Batch import
  </div>
  <div class="card-body">
    <p class="text-muted">Upload a CSV file to enroll multiple students and select modules in bulk.</p>
    <ul>
      <li>Supported columns: <code>student_id</code>, <code>course_id</code>, <code>graduation_date</code> (optional)</li>
      <li>Accepts files with or without a header row</li>
      <li>Date format recommended: <code>YYYY-MM-DD</code></li>
    </ul>
    <form method="post" action="/students/bulk_upload" enctype="multipart/form-data" class="row g-3">
      <div class="col-md-6" lang="en">
        <label for="csv_file" class="form-label">Open File</label>
        <input type="file" id="csv_file" name="csv_file" class="visually-hidden" accept=".csv" required>
        <label for="csv_file" class="btn btn-secondary">Choose CSV file</label>
        <span id="csv_file_name" class="ms-2 text-muted">No file chosen</span>
      </div>
      <div class="col-12">
        <button type="submit" class="btn btn-secondary">Upload and Import</button>
      </div>
    </form>
  </div>
</div>

<script>
  (function() {
    const input = document.getElementById('csv_file');
    const nameSpan = document.getElementById('csv_file_name');
    if (nameSpan && !nameSpan.textContent) {
      nameSpan.textContent = 'No file chosen';
    }
    if (input) {
      input.addEventListener('change', function() {
        nameSpan.textContent = (input.files && input.files[0]) ? input.files[0].name : 'No file chosen';
      });
    }
  })();
</script>

{% endblock %}
